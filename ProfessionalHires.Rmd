---
title: "ProfessionalHires"
output: html_document
---

### Install Necessary Libraries

```{r}
library(dplyr) 
library(ggplot2) 
#
library(tidyverse)
library(modelr)
```

### Store csv file as a data frame

```{r}
profhires.df <- read.csv('data/professionalhires.csv')
profhires.df
```

### Create Calculated Columns (Percentage)
```{r}
# Calculate total number of new hires for each year
total.df <- aggregate(. ~ Year, data=profhires.df, FUN=sum)

# Merge tables
merged.df <- merge(profhires.df, total.df, by="Year")
merged.df$Percentage <- merged.df$Count.x / merged.df$Count.y

# Add Total Hires Column
profhires.df$TotalHiresPerYear <- merged.df$Count.y

# Add Percentage Column
profhires.df$Percentage <- merged.df$Percentage

profhires.df



# Split by Campus
UWTacoma <- profhires.df %>% 
  filter(College == "UW Tacoma")
UWTacoma

UWBothell <- profhires.df %>% 
  filter(College == "UW Bothell")
UWBothell

UWSeattle <- profhires.df %>% 
  filter(College != "UW Tacoma", College != "UW Bothell")
UWSeattle <- aggregate(. ~ Year, data=UWSeattle, FUN=sum)
UWSeattle$College <- "UW Seattle"
UWSeattle$College = as.factor(UWSeattle$College)
UWSeattle$TotalHiresPerYear <- total.df$Count
UWSeattle$Percentage = UWSeattle$Count / UWSeattle$TotalHiresPerYear

AllCampus <- union(UWBothell, UWTacoma)
AllCampus <- union(AllCampus, UWSeattle)

```

### Plot data
```{r}
## Plot total count over time for all colleges

# scatterplot
overallPlot <- ggplot(data = total.df, aes(x = Year, y = Count)) +
  geom_point() +
    geom_smooth(method = "lm") # LINES ARE NOT SHOWING UP ON GRAPH?? :(
overallPlot

# bar graph
overallBar <- ggplot(data = total.df, aes(x = Year, y = Count)) +
    geom_bar(stat="identity")
overallBar



## Plot counts over time for each College 

basicPlotC <- ggplot(data = profhires.df, aes(x = Year, y = Count)) +
    geom_point() +
       geom_smooth(method = "lm") # LINES ARE NOT SHOWING UP ON GRAPH?? :(
basicPlotC

# scatter plot - Colleges separate by color
colorPlotC <- ggplot(data = profhires.df, aes(x = Year, y = Count, color = College)) +
    geom_point() +
      geom_line()  # LINES ARE NOT SHOWING UP ON GRAPH?? :(
colorPlotC

# scatter plot - Colleges separate by facets
facetPlotC <- basicPlotC + facet_wrap( ~ College, ncol=3)
facetPlotC

# bar graph - College sepeated by stacked bars
stackedBarC <- ggplot(data = profhires.df, aes(x = Year, y = Count, fill = College )) +
    geom_bar(stat="identity")
stackedBarC










## Plot percentages over time for each College 

basicPlot <- ggplot(data = profhires.df, aes(x = Year, y = Percentage)) +
    geom_point() +
       geom_smooth(method = "lm") # LINES ARE NOT SHOWING UP ON GRAPH?? :(
basicPlot

# scatter plot - Colleges separate by color
colorPlot <- ggplot(data = profhires.df, aes(x = Year, y = Percentage, color = College)) +
    geom_point() +
      geom_line()  # LINES ARE NOT SHOWING UP ON GRAPH?? :(
colorPlot

# scatter plot - Colleges separate by facets
facetPlot <- basicPlot + facet_wrap( ~ College, ncol=3)
facetPlot

# bar graph - College sepeated by stacked bars
stackedBar <- ggplot(data = profhires.df, aes(x = Year, y = Count, fill = College )) +
    geom_bar(stat="identity")
stackedBar


# idk what's the best way to display the data from the above options ^^^^^^^

```


### Informatics
```{r}

iSchool.df <- profhires.df %>% 
  filter(College == "Information School")

g <- ggplot(data = iSchool.df, aes(x = Year, y = Percentage))
g + geom_point()  + geom_smooth(method = "lm") 
            

gg <- ggplot(data = iSchool.df, aes(x = Year, y = Count))
gg + geom_point()  + geom_smooth(method = "lm") 
          

```


### By UW Campus
```{r}

# by counts
campusPlot <- ggplot(data = AllCampus, aes(x = Year, y = Count, color = College)) +
    geom_point() +
      geom_line()  # LINES ARE NOT SHOWING UP ON GRAPH?? :(
campusPlot


#by percentage
campusPlott <- ggplot(data = AllCampus, aes(x = Year, y = Percentage, color = College)) +
    geom_point() +
      geom_line()  # LINES ARE NOT SHOWING UP ON GRAPH?? :(
campusPlott


```